<!DOCTYPE html>
<html lang="vi" xmlns:th="http://www.thymeleaf.org" layout:decorate="~{layout.html}"
      xmlns:layout="http://www.w3.org/1999/xhtml">
<head><title>Qu·∫£n l√Ω User</title></head>
<body>
<div layout:fragment="content">
    <div class="d-flex justify-content-between mb-4 align-items-center">
        <h2 class="text-white fw-bold">üë• Qu·∫£n l√Ω Ng∆∞·ªùi d√πng</h2> <div>
        <a th:href="@{/admin/categories}" class="btn btn-light fw-bold text-primary shadow-sm me-2">
            üìÇ Qu·∫£n l√Ω Danh m·ª•c
        </a>
        <a th:href="@{/admin/posts}" class="btn btn-light fw-bold text-primary shadow-sm">
            üìù Qu·∫£n l√Ω B√†i vi·∫øt
        </a>
    </div>
    </div>

    <div th:if="${successMessage}" class="alert alert-success" th:text="${successMessage}"></div>
    <div th:if="${errorMessage}" class="alert alert-danger" th:text="${errorMessage}"></div>

    <div class="card shadow-sm">
        <div class="card-body">
            <table class="table table-hover">
                <thead>
                <tr>
                    <th>ID</th>
                    <th>Avatar</th>
                    <th>T√™n</th>
                    <th>Email</th>
                    <th>Role</th>
                    <th>Tr·∫°ng th√°i</th>
                    <th>H√†nh ƒë·ªông</th>
                </tr>
                </thead>
                <tbody>
                <tr th:each="user : ${users}">
                    <td th:text="${user.id}">1</td>
                    <td>
                        <img th:if="${user.avatarUrl != null}" th:src="@{/view-file/{f}(f=${user.avatarUrl})}" width="30" height="30" class="rounded-circle">
                        <span th:if="${user.avatarUrl == null}">üë§</span>
                    </td>
                    <td th:text="${user.username}">user</td>
                    <td th:text="${user.email}">email</td>
                    <td>
                        <span th:each="role : ${user.roles}" th:text="${role.name} + ' '" class="badge bg-secondary"></span>
                    </td>
                    <td>
                        <span th:if="${user.enabled}" class="badge bg-success">Ho·∫°t ƒë·ªông</span>
                        <span th:if="${!user.enabled}" class="badge bg-danger">ƒê√£ kh√≥a</span>
                    </td>
                    <td>
                        <div class="d-flex gap-2">
                            <form th:action="@{/admin/users/{id}/toggle-status(id=${user.id})}" method="POST">
                                <button type="submit" class="btn btn-sm"
                                        th:classappend="${user.enabled ? 'btn-warning' : 'btn-success'}"
                                        th:text="${user.enabled ? 'üîí Kh√≥a' : 'üîì M·ªü'}"></button>
                            </form>
                            <form th:action="@{/admin/users/{id}/delete(id=${user.id})}" method="POST"
                                  onsubmit="return confirm('X√≥a user n√†y s·∫Ω m·∫•t h·∫øt d·ªØ li·ªáu li√™n quan. Ch·∫Øc ch·∫Øn?');">
                                <button type="submit" class="btn btn-sm btn-danger">üóëÔ∏è X√≥a</button>
                            </form>
                        </div>
                    </td>
                </tr>
                </tbody>
            </table>
        </div>
    </div>
</div>
</body>
</html>