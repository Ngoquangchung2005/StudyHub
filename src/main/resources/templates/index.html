<!DOCTYPE html>
<html lang="vi"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security"
      layout:decorate="~{layout.html}">
<head>
    <title th:text="${pageTitle}">Trang ch·ªß</title>
    <style>
        /* CSS cho n√∫t Xem tr∆∞·ªõc */
        .btn-preview {
            border-radius: 20px;
            background-color: #f0f2f5;
            color: #333;
            border: 1px solid #ddd;
            font-weight: 600;
            transition: all 0.2s;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            padding: 4px 12px;
            font-size: 0.9rem;
        }
        .btn-preview:hover {
            background-color: #e4e6eb;
            color: #000;
        }

        /* Modal preview full height */
        .preview-iframe {
            width: 100%;
            height: 75vh;
            border: none;
            border-radius: 8px;
            background-color: #f8f9fa;
        }

        .preview-image {
            max-width: 100%;
            max-height: 75vh;
            display: block;
            margin: 0 auto;
            border-radius: 8px;
        }
    </style>
</head>
<body>

<div layout:fragment="content">

    <div class="row justify-content-center">

        <div class="col-lg-3 d-none d-lg-block">
            <div class="card sidebar-left">
                <div class="card-body">
                    <h5 class="card-title">Menu</h5>
                    <ul class="list-group list-group-flush">
                        <li class="list-group-item">
                            <a th:href="@{/profile/edit}" class="text-decoration-none text-dark">‚öôÔ∏è C√†i ƒë·∫∑t t√†i kho·∫£n</a>
                        </li>
                        <li class="list-group-item">
                            <a th:href="@{/documents}" class="text-decoration-none text-dark">üìÇ Kho t√†i li·ªáu</a>
                        </li>
                        <li class="list-group-item">
                            <a th:href="@{/chat}" class="text-decoration-none text-dark">üí¨ Tin nh·∫Øn</a>
                        </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="col-lg-6 col-md-8">

            <div class="card mb-4 shadow-sm" style="border-radius: 15px; border: none;">
                <div class="card-body p-3">
                    <form th:action="@{/}" method="GET" class="d-flex align-items-center">
                        <div class="input-group">
                            <span class="input-group-text bg-white border-end-0" style="border-radius: 20px 0 0 20px; border: 1px solid #e0e0e0;">
                                üîç
                            </span>
                            <input type="text" name="keyword"
                                   class="form-control border-start-0"
                                   placeholder="T√¨m ki·∫øm t√†i li·ªáu, b√†i vi·∫øt, tags..."
                                   th:value="${keyword}"
                                   style="border-radius: 0 20px 20px 0; border: 1px solid #e0e0e0; box-shadow: none;">
                            <button type="submit" class="btn btn-primary ms-2 fw-bold"
                                    style="border-radius: 20px; background: linear-gradient(135deg, #667eea, #764ba2); border: none; padding: 8px 20px;">
                                T√¨m
                            </button>
                        </div>
                        <a th:if="${keyword != null && !keyword.isEmpty()}"
                           th:href="@{/}"
                           class="btn btn-light ms-2"
                           style="border-radius: 50%; width: 40px; height: 40px; display: flex; align-items: center; justify-content: center;"
                           title="X√≥a t√¨m ki·∫øm">
                            ‚úñ
                        </a>
                    </form>
                </div>
            </div>

            <div th:if="${successMessage}" class="alert alert-success" role="alert">
                <span th:text="${successMessage}"></span>
            </div>
            <div th:if="${errorMessage}" class="alert alert-danger" role="alert">
                <span th:text="${errorMessage}"></span>
            </div>

            <h2 class="h4 mb-3" th:if="${keyword == null}">B√†i ƒëƒÉng g·∫ßn ƒë√¢y</h2>
            <h2 class="h4 mb-3" th:if="${keyword != null}">K·∫øt qu·∫£ t√¨m ki·∫øm cho: "<span th:text="${keyword}"></span>"</h2>

            <div th:if="${posts == null || posts.isEmpty()}" class="alert alert-info">
                <span th:if="${keyword == null}">Ch∆∞a c√≥ b√†i ƒëƒÉng n√†o.</span>
                <span th:if="${keyword != null}">Kh√¥ng t√¨m th·∫•y k·∫øt qu·∫£ n√†o ph√π h·ª£p.</span>
            </div>

            <div class="card mb-3" th:each="post : ${posts}">
                <div class="card-body">

                    <div class="d-flex justify-content-between align-items-start mb-2">
                        <div class="d-flex align-items-center">
                            <a th:href="@{/profile/{username}(username=${post.user.username})}">
                                <div class="post-author-avatar">
                                    <img th:if="${post.user.avatarUrl != null}"
                                         th:src="@{/view-file/{fileName}(fileName=${post.user.avatarUrl})}"
                                         alt="Avatar">
                                    <span th:if="${post.user.avatarUrl == null}"
                                          th:text="${#strings.substring(post.user.name, 0, 1)}">
                                        A
                                    </span>
                                </div>
                            </a>
                            <div class="ms-2">
                                <a class="fw-bold text-decoration-none text-dark"
                                   th:href="@{/profile/{username}(username=${post.user.username})}"
                                   th:text="${post.user.name}">T√™n T√°c Gi·∫£</a>
                                <div class="text-muted small">
                                    <span th:text="${#temporals.format(post.createdAt, 'HH:mm ''ng√†y'' dd/MM/yyyy')}">
                                        Ng√†y ƒëƒÉng
                                    </span>
                                    <span th:if="${post.isPublic}" title="C√¥ng khai">üåê</span>
                                    <span th:if="${!post.isPublic}" title="Ri√™ng t∆∞">üîí</span>
                                </div>
                            </div>
                        </div>

                        <div class="dropdown" th:if="${currentUserId == post.user.id}">
                            <button class="btn btn-link text-dark p-0" type="button" data-bs-toggle="dropdown" aria-expanded="false" style="text-decoration: none; font-size: 20px;">
                                ‚ãÆ
                            </button>
                            <ul class="dropdown-menu dropdown-menu-end border-0 shadow">
                                <li>
                                    <a class="dropdown-item py-2" th:href="@{/posts/edit/{id}(id=${post.id})}">
                                        ‚úèÔ∏è Ch·ªânh s·ª≠a b√†i vi·∫øt
                                    </a>
                                </li>
                                <li><hr class="dropdown-divider"></li>
                                <li>
                                    <form th:action="@{/posts/delete/{id}(id=${post.id})}" method="POST"
                                          onsubmit="return confirm('B·∫°n c√≥ ch·∫Øc ch·∫Øn mu·ªën x√≥a b√†i vi·∫øt n√†y kh√¥ng? H√†nh ƒë·ªông n√†y kh√¥ng th·ªÉ ho√†n t√°c.');">
                                        <button type="submit" class="dropdown-item py-2 text-danger">
                                            üóëÔ∏è X√≥a b√†i vi·∫øt
                                        </button>
                                    </form>
                                </li>
                            </ul>
                        </div>
                    </div>

                    <p class="card-text" th:if="${post.content != null && !post.content.isEmpty()}"
                       th:text="${post.content}">N·ªôi dung b√†i ƒëƒÉng...</p>

                    <div th:if="${post.documents != null && !post.documents.isEmpty()}" class="mt-3">
                        <div class="list-group">
                            <div th:each="doc : ${post.documents}"
                                 class="list-group-item list-group-item-action flex-column align-items-start mb-2 border rounded p-3">

                                <div class="d-flex w-100 justify-content-between align-items-center">
                                    <h5 class="mb-1 fw-bold" style="font-size: 1.1rem;">
                                        üìÑ
                                        <span th:text="${doc.title != null && !doc.title.isEmpty() ? doc.title : doc.fileName}">
                                            Ti√™u ƒë·ªÅ t√†i li·ªáu
                                        </span>
                                    </h5>

                                    <div class="d-flex gap-2">
                                        <button type="button"
                                                class="btn-preview"
                                                th:onclick="previewFile([[${doc.storagePath}]], [[${doc.fileName}]], [[${doc.title}]])"
                                                title="Xem tr∆∞·ªõc">
                                            üëÅÔ∏è Xem
                                        </button>

                                        <a th:href="@{/download/{fileName}(fileName=${doc.storagePath})}"
                                           class="btn btn-sm btn-primary ms-1 flex-shrink-0"
                                           style="border-radius: 20px; display: flex; align-items: center;">
                                            ‚¨á T·∫£i xu·ªëng
                                        </a>
                                    </div>
                                </div>

                                <p class="mb-1"
                                   th:if="${doc.description != null && !doc.description.isEmpty() && doc.description != post.content}"
                                   th:text="${doc.description}">
                                    M√¥ t·∫£ t√†i li·ªáu...
                                </p>

                                <small class="text-muted d-block mt-2">
                                    <span th:if="${doc.category != null}"
                                          class="badge bg-secondary me-2"
                                          th:text="${doc.category.name}">Category</span>
                                    <span th:text="${doc.fileName} + ' (' + (${doc.fileSize < 1024*1024 ? #numbers.formatDecimal(doc.fileSize / 1024.0, 1, 'COMMA', 1, 'POINT') + ' KB' : #numbers.formatDecimal(doc.fileSize / 1024.0 / 1024.0, 1, 'COMMA', 1, 'POINT') + ' MB'}) + ')'">
                                        size
                                    </span>
                                </small>
                            </div>
                        </div>
                    </div>

                    <hr>

                    <div class="d-flex gap-3">
                        <form th:action="@{/posts/{postId}/like(postId=${post.id})}" method="POST" class="d-inline">
                            <button type="submit" class="btn btn-link text-decoration-none p-0"
                                    th:with="liked = ${#lists.contains(post.reactions.![user.id], currentUserId)}"
                                    th:classappend="${liked ? 'text-primary fw-bold' : 'text-dark'}">
                                üëç Th√≠ch
                                <span th:text="${post.reactions.size()}">0</span>
                            </button>
                        </form>
                        <a href="#" class="text-decoration-none text-dark">
                            üí¨ B√¨nh lu·∫≠n
                            <span th:text="${post.comments.size()}">0</span>
                        </a>
                    </div>

                    <hr>

                    <div class="comments-section" th:id="'comments-area-' + ${post.id}">
                        <div th:each="comment : ${post.comments}"
                             th:id="'comment-' + ${comment.id}"
                             class="mb-2 d-flex group-comment-item">

                            <div class="post-author-avatar me-2" style="width: 32px; height: 32px; font-size: 0.9rem;">
                                <img th:if="${comment.user.avatarUrl != null}"
                                     th:src="@{/view-file/{fileName}(fileName=${comment.user.avatarUrl})}" alt="Avatar">
                                <span th:if="${comment.user.avatarUrl == null}"
                                      th:text="${#strings.substring(comment.user.name, 0, 1)}"></span>
                            </div>

                            <div class="ms-2 position-relative" style="background-color: #f0f2f5; border-radius: 15px; padding: 8px 12px; flex-grow: 1;">
                                <strong>
                                    <a th:href="@{/profile/{username}(username=${comment.user.username})}"
                                       th:text="${comment.user.name}"
                                       style="text-decoration: none; color: inherit;">T√™n User</a>
                                </strong>
                                <p th:text="${comment.content}" class="mb-0">N·ªôi dung.</p>
                                <small class="text-muted" th:text="${#temporals.format(comment.createdAt, 'HH:mm dd/MM/yyyy')}"></small>

                                <button th:if="${currentUser != null && (comment.user.id == currentUser.id || post.user.id == currentUser.id)}"
                                        class="btn btn-sm text-danger position-absolute top-0 end-0 p-1 delete-comment-btn"
                                        th:attr="data-id=${comment.id}"
                                        style="font-size: 12px; margin-right: 5px;"
                                        title="X√≥a b√¨nh lu·∫≠n"
                                        type="button">
                                    ‚úñ
                                </button>
                            </div>
                        </div>
                    </div>

                    <div class="mt-3" sec:authorize="isAuthenticated()">
                        <form th:action="@{/posts/{postId}/comment(postId=${post.id})}"
                              th:object="${commentDto}" method="POST" class="d-flex">
                            <div class="post-author-avatar me-2" style="width: 32px; height: 32px; font-size: 0.9rem;">
                                <img th:if="${currentUser != null && currentUser.avatarUrl != null}"
                                     th:src="@{/view-file/{fileName}(fileName=${currentUser.avatarUrl})}"
                                     alt="Avatar">
                                <span th:if="${currentUser == null || currentUser.avatarUrl == null}"
                                      th:text="${currentUser != null ? #strings.substring(currentUser.name, 0, 1) : '?'}">
                                </span>
                            </div>
                            <input type="text" class="form-control" th:field="*{content}"
                                   placeholder="Vi·∫øt b√¨nh lu·∫≠n..." style="border-radius: 20px;"/>
                            <button type="submit" class="btn btn-primary ms-2" style="border-radius: 20px;">G·ª≠i</button>
                        </form>
                    </div>

                </div>
            </div>
        </div>

        <div class="col-lg-3 col-md-4">
            <div class="card sidebar-right">
                <div class="card-body">
                    <h5 class="card-title">Li√™n h·ªá</h5>

                    <div class="user-list-container" th:if="${contacts != null && !contacts.isEmpty()}">
                        <div th:each="contact : ${contacts}"
                             th:if="${contact.type == T(com.studyhub.StudyHub.entity.ChatRoom.RoomType).ONE_TO_ONE}">
                            <a th:href="@{/chat(withUser=${contact.oneToOnePartnerId})}" class="user-list-item-link">
                                <div th:with="isOnline = ${onlineUsers.contains(contact.oneToOnePartnerUsername)}"
                                     class="user-list-item">
                                    <div class="user-avatar-container">
                                        <img th:if="${contact.oneToOnePartnerAvatarUrl != null}"
                                             th:src="@{/view-file/{fileName}(fileName=${contact.oneToOnePartnerAvatarUrl})}"
                                             class="user-avatar-image">
                                        <div th:if="${contact.oneToOnePartnerAvatarUrl == null}"
                                             class="user-avatar-default">
                                            <span th:text="${#strings.substring(contact.oneToOnePartnerName, 0, 1)}"></span>
                                        </div>
                                        <span class="status-dot" th:classappend="${isOnline ? 'online' : ''}"></span>
                                    </div>
                                    <div class="user-info">
                                        <span class="user-name" th:text="${contact.oneToOnePartnerName}">T√™n</span>
                                    </div>
                                </div>
                            </a>
                        </div>
                    </div>

                    <p th:if="${contacts == null || contacts.isEmpty()}" class="text-muted small">
                        B·∫°n ch∆∞a nh·∫Øn tin v·ªõi ai.
                    </p>
                </div>
            </div>
        </div>

    </div>

    <div class="modal fade" id="previewModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-xl modal-dialog-centered">
            <div class="modal-content" style="border-radius: 15px; overflow: hidden;">
                <div class="modal-header border-0 bg-light py-2">
                    <h5 class="modal-title fw-bold text-primary" id="previewTitle">üìÑ Xem t√†i li·ªáu</h5>
                    <div class="ms-auto d-flex gap-2">
                        <a href="#" id="previewDownloadBtn" class="btn btn-primary btn-sm rounded-pill">‚¨á T·∫£i xu·ªëng</a>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                </div>
                <div class="modal-body p-0 bg-light text-center d-flex align-items-center justify-content-center" style="min-height: 400px;">
                    <div id="previewContent" class="w-100 h-100">
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script layout:fragment="scripts">
        // --- 1. X·ª¨ L√ù PREVIEW FILE (Gi·ªØ nguy√™n) ---
        function previewFile(storagePath, fileName, title) {
            const modal = new bootstrap.Modal(document.getElementById('previewModal'));
            const contentDiv = document.getElementById('previewContent');
            const titleEl = document.getElementById('previewTitle');
            const downloadBtn = document.getElementById('previewDownloadBtn');

            titleEl.textContent = title || fileName;
            downloadBtn.href = '/download/' + storagePath;

            const ext = fileName.split('.').pop().toLowerCase();
            const fileUrl = '/view-file/' + storagePath;
            let html = '';

            if (['jpg', 'jpeg', 'png', 'gif', 'webp', 'svg'].includes(ext)) {
                html = `<img src="${fileUrl}" class="preview-image" alt="Preview">`;
            } else if (ext === 'pdf') {
                html = `<iframe src="${fileUrl}" class="preview-iframe"></iframe>`;
            } else if (ext === 'txt') {
                html = `<iframe src="${fileUrl}" class="preview-iframe" style="background: white;"></iframe>`;
            } else if (['mp4', 'webm', 'ogg'].includes(ext)) {
                html = `<video controls class="preview-image" style="background:black;"><source src="${fileUrl}" type="video/${ext}">Tr√¨nh duy·ªát kh√¥ng h·ªó tr·ª£ video n√†y.</video>`;
            } else {
                html = `<div class="text-center p-5"><h4>Kh√¥ng h·ªó tr·ª£ xem tr∆∞·ªõc ƒë·ªãnh d·∫°ng n√†y</h4><a href="/download/${storagePath}" class="btn btn-lg btn-primary mt-2 rounded-pill">‚¨á T·∫£i xu·ªëng m√°y</a></div>`;
            }
            contentDiv.innerHTML = html;
            modal.show();
        }

        // --- 2. X·ª¨ L√ù REALTIME (G·ªòP CHUNG TH√äM & X√ìA) ---
        let stompClientFeed = null;

        function connectFeed() {
            const socket = new SockJS('/ws');
            stompClientFeed = Stomp.over(socket);
            stompClientFeed.debug = null; // T·∫Øt log debug cho g·ªçn

            stompClientFeed.connect({}, function (frame) {
                console.log('Connected Realtime Feed');

                // ƒêƒÉng k√Ω l·∫Øng nghe k√™nh chung "/topic/comments"
                stompClientFeed.subscribe('/topic/comments', function (payload) {
                    const data = JSON.parse(payload.body);

                    // KI·ªÇM TRA LO·∫†I TIN NH·∫ÆN
                    if (data.type === 'DELETE_COMMENT') {
                        // ==> N·∫æU L√Ä L·ªÜNH X√ìA
                        handleDeleteCommentUI(data.commentId);
                    } else {
                        // ==> N·∫æU KH√îNG C√ì TYPE HO·∫∂C L√Ä COMMENT M·ªöI
                        // (Gi·∫£ s·ª≠ server g·ª≠i object comment ƒë·∫ßy ƒë·ªß khi th√™m m·ªõi)
                        appendNewComment(data);
                    }
                });

            }, function (error) {
                console.log('WS Error: ' + error);
            });
        }

        // H√†m 2.1: X·ª≠ l√Ω giao di·ªán khi c√≥ l·ªánh x√≥a
        function handleDeleteCommentUI(commentId) {
            const commentElement = document.getElementById('comment-' + commentId);
            if (commentElement) {
                commentElement.style.transition = "opacity 0.5s ease";
                commentElement.style.opacity = "0"; // L√†m m·ªù
                setTimeout(() => commentElement.remove(), 500); // X√≥a kh·ªèi DOM sau 0.5s
            }
        }

        // H√†m 2.2: G·ª≠i l·ªánh x√≥a l√™n Server (khi b·∫•m n√∫t X)
        function deleteComment(commentId) {
            const csrfToken = document.querySelector('meta[name="_csrf"]').getAttribute('content');
            const csrfHeader = document.querySelector('meta[name="_csrf_header"]').getAttribute('content');

            fetch('/api/comments/' + commentId + '/delete', {
                method: 'POST',
                headers: { [csrfHeader]: csrfToken }
            }).then(response => {
                if (!response.ok) alert("L·ªói khi x√≥a b√¨nh lu·∫≠n.");
            }).catch(err => console.error(err));
        }

        // H√†m 2.3: V·∫Ω comment m·ªõi l√™n giao di·ªán (Gi·ªØ nguy√™n logic c≈© c·ªßa b·∫°n)
        function appendNewComment(cmt) {
            // Ki·ªÉm tra d·ªØ li·ªáu h·ª£p l·ªá tr∆∞·ªõc khi v·∫Ω (tr√°nh l·ªói n·∫øu nh·∫≠n nh·∫ßm g√≥i tin x√≥a)
            if (!cmt.content || !cmt.postId) return;

            const commentArea = document.getElementById('comments-section-' + cmt.postId) ||
                // Fallback: T√¨m trong danh s√°ch c≈© n·∫øu ch∆∞a c√≥ ID c·ª• th·ªÉ
                document.querySelector(`#comment-${cmt.id}`)?.parentNode ||
                // Fallback 2: T√¨m theo c·∫•u tr√∫c HTML c·ªßa b·∫°n
                document.querySelectorAll('.card-body')[0]?.querySelector('.comments-section');

            // S·ª≠a l·∫°i selector t√¨m v√πng ch·ª©a comment cho ch√≠nh x√°c v·ªõi HTML c·ªßa b·∫°n
            // Trong file b·∫°n g·ª≠i, v√πng ch·ª©a l√† <div class="comments-section"> b√™n trong m·ªói post
            // ƒê·ªÉ ch√≠nh x√°c nh·∫•t, b·∫°n n√™n th√™m th:id="'comments-area-' + ${post.id}" v√†o th·∫ª <div class="comments-section"> trong HTML

            // T·∫°m th·ªùi d√πng logic t√¨m container ƒë∆°n gi·∫£n (c√≥ th·ªÉ c·∫ßn ƒëi·ªÅu ch·ªânh ID trong HTML):
            // Gi·∫£ s·ª≠ b·∫°n ƒë√£ th√™m id="comments-area-{postId}" v√†o div ch·ª©a comment
            const container = document.getElementById('comments-area-' + cmt.postId);

            if (container) {
                const initial = cmt.senderName.charAt(0).toUpperCase();
                const avatarHtml = cmt.senderAvatar ?
                    `<img src="/view-file/${cmt.senderAvatar}" alt="Avatar">` :
                    `<span>${initial}</span>`;

                // HTML comment m·ªõi (c√≥ th√™m n√∫t x√≥a)
                // L∆∞u √Ω: N√∫t x√≥a ·ªü ƒë√¢y ch·ªâ hi·ªÉn th·ªã gi·∫£ ƒë·ªãnh, logic server s·∫Ω ch·∫∑n n·∫øu kh√¥ng ph·∫£i ch·ªß
                const deleteBtnHtml = `
                <button class="btn btn-sm text-danger position-absolute top-0 end-0 p-1 delete-comment-btn"
                        data-id="${cmt.id}" style="font-size: 12px; margin-right: 5px;" title="X√≥a">‚úñ</button>
            `;

                const html = `
                <div id="comment-${cmt.id}" class="mb-2 d-flex group-comment-item animate-fade-in">
                    <div class="post-author-avatar me-2" style="width: 32px; height: 32px; font-size: 0.9rem;">
                        ${avatarHtml}
                    </div>
                    <div class="ms-2 position-relative" style="background-color: #f0f2f5; border-radius: 15px; padding: 8px 12px; flex-grow: 1;">
                        <strong>
                            <a href="/profile/${cmt.senderUsername}" style="text-decoration: none; color: inherit;">${cmt.senderName}</a>
                        </strong>
                        <p class="mb-0">${cmt.content}</p>
                        <small class="text-muted">V·ª´a xong</small>
                        ${deleteBtnHtml}
                    </div>
                </div>
            `;
                container.insertAdjacentHTML('beforeend', html);
            }
        }

        // --- 3. ƒêƒÇNG K√ù S·ª∞ KI·ªÜN ---

        // ·ª¶y quy·ªÅn s·ª± ki·ªán click cho n√∫t x√≥a (ƒë·ªÉ ho·∫°t ƒë·ªông v·ªõi c·∫£ comment m·ªõi th√™m)
        document.addEventListener('click', function(e) {
            if (e.target && e.target.classList.contains('delete-comment-btn')) {
                e.preventDefault();
                const commentId = e.target.getAttribute('data-id');
                if (confirm("B·∫°n c√≥ ch·∫Øc ch·∫Øn mu·ªën x√≥a b√¨nh lu·∫≠n n√†y?")) {
                    deleteComment(commentId);
                }
            }
        });

        // Th√™m style animation
        const style = document.createElement('style');
        style.innerHTML = `.animate-fade-in { animation: fadeIn 0.5s ease-in; } @keyframes fadeIn { from { opacity: 0; transform: translateY(5px); } to { opacity: 1; transform: translateY(0); } }`;
        document.head.appendChild(style);

        // Ch·∫°y khi load trang
        document.addEventListener('DOMContentLoaded', connectFeed);
    </script>

</div>
<div class="modal fade" id="deleteCommentModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal-sm"> <div class="modal-content" style="border-radius: 20px; border: none; box-shadow: 0 10px 40px rgba(0,0,0,0.2);">

        <div class="modal-body text-center pt-4 pb-0">
            <div style="width: 60px; height: 60px; background-color: #fee2e2; color: #dc2626; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 28px; margin: 0 auto 15px auto;">
                üóëÔ∏è
            </div>
            <h5 class="fw-bold text-dark mb-2">X√≥a b√¨nh lu·∫≠n?</h5>
            <p class="text-muted small mb-3">
                B·∫°n c√≥ ch·∫Øc ch·∫Øn mu·ªën x√≥a b√¨nh lu·∫≠n n√†y kh√¥ng? H√†nh ƒë·ªông n√†y kh√¥ng th·ªÉ ho√†n t√°c.
            </p>
        </div>

        <div class="modal-footer border-0 justify-content-center pb-4 pt-0 gap-2">
            <button type="button" class="btn btn-light fw-bold px-3" data-bs-dismiss="modal"
                    style="border-radius: 12px; min-width: 80px;">
                H·ªßy
            </button>
            <button type="button" class="btn btn-danger fw-bold px-3" id="btn-confirm-delete-comment"
                    style="border-radius: 12px; min-width: 80px; background-color: #dc2626; border: none;">
                X√≥a
            </button>
        </div>
    </div>
    </div>
</div>
</body>
</html>